This code accompanies the article: https://medium.com/@gzozulin